---
title: "Reproducible Research Peer Ass. 1"
author: "Bentley"
date: "November 15, 2014"
output:
  html_document:
    keep_md: yes
---

The following analysis is conducted on observations that occurred over a period of 61 days on a single subject.
Steps were recorded continuously and summed into 5 minute time intervals.
Each time interval was recorded in the hhmm format with no padding e.g. 00:00 as 0 and 23:30 as 2330

Loading and preprocessing the data

```{r loadlibraries}
library(xtable)  ##  install xtable to be able to present tables in a neat format
```


```{r loadthedata}
activity<- read.csv("~/Documents/R Working Directory/Coursera/Scripts/RepResProject1/activity.csv", colClasses = "character")
activity$steps<-as.numeric(activity$steps)  ## converting the steps variable to class numeric
activity$date<-as.Date(activity$date)     ## converting the date variable to class date
activity$interval<-as.numeric(activity$interval)  ## converting the interval variable to class numeric
activitycomp<-activity[complete.cases(activity),]  ## removing the NAs
```

## What is the mean total number of steps taken per day?

```{r plottinghistogram}
hist(tapply(as.numeric(activitycomp$steps),activitycomp$date,FUN=sum))
```

### The mean steps per day are as follows:

```{r}
meansteps<-aggregate(activitycomp$steps ~ activitycomp$date,FUN=mean)
print(meansteps)
```

### The median steps per day are as follows:

```{r}
mediansteps<-aggregate(activitycomp$steps ~ activitycomp$date,FUN=median)
print(mediansteps)
```
## What is the average daily activity pattern?

```{r timeseriesplot}
timeseries<-aggregate(activitycomp$steps ~ activitycomp$interval,FUN=mean)
colnames(timeseries)<-c('interval','meansteps') # naming the columns
plot(timeseries$interval,timeseries$meansteps,type="l")
```

```{r}
maxinterval <-timeseries[timeseries$meansteps==max(timeseries$meansteps),1]
```
The 5-minute interval, on average across all the days in the dataset, that contains the maximum number of steps is `r maxinterval`